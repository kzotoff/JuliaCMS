<?php/*CMS login/logout routines. Note that it doesn't intersect auth module*/function login_logout() {	// display login page instead any content, if requested	if (isset($_GET['login']) && (!isset($_SESSION['CMS_AUTH_USER']) || ($_SESSION['CMS_AUTH_USER'] == ''))) {		readfile('lib/login.html');		terminate();	}	// check login/password if any	if (isset($_POST['action']) && ($_POST['action'] == 'checklogin')) {		if ((@$_POST['userlogin'] == 'admin') && (@$_POST['userpassword'] == CMS_ADMIN_PASSWORD)) {			$_SESSION['CMS_AUTH_USER'] = 'admin';		}	}	// or logout?	if (isset($_GET['logout'])) {		$_SESSION['CMS_AUTH_USER'] = '';		unset($_SESSION['CMS_AUTH_USER']);		terminate('', 'Location: ./', 302);	}}// user rights checkfunction user_allowed_to($action, $params = array()) {	$username = isset($_SESSION['CMS_AUTH_USER']) ? $_SESSION['CMS_AUTH_USER'] : '';		// admin godmode	if ($username == 'admin') {		return true;	}		// list all actions here, even not secured by now.	switch ($action) {			case 'manage site': break;               // common admin access			case 'manage modules': break;            // allow module settings			case 'change other passwords': break;    // universav password changer			case 'backup works': break;              // backup/restore/download/delete			case 'manage pages': break;              // add/delete pages			case 'edit pages': break;                // edit pages			case 'manage files': break;              // user's files works			case 'manage menu': break;               // menu			case 'manage news': break;               // news			case 'search': return true; break;       // news			case 'manage feedback templates': break;			case 'chat': break;	}			// "no" by default	return false;}?>